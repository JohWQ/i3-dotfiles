## ========================================================= ##
## i3 CONFIG FILE (v4)
## https://i3wm.org/docs/userguide.html
## ========================================================= ##

include $HOME/.config/i3/modes.conf

## ---------------------- BASIC SETTINGS ---------------------- ##
set $mod Mod4
# reload the configuration file
bindsym $mod+Shift+c reload
# restart i3 and i3status-rs
bindsym $mod+Shift+r restart
# refresh monitor layout
bindsym $mod+Shift+Control+r exec --no-startup-id xrandr --output $monitor1 --primary --mode 1920x1080 --rate 144.00 --pos 0x420 --output $monitor2 --mode 1920x1080 --rate 144.00 --pos 1920x0 --rotate left && sleep 2 && notify-send -t 2000 "Resolution reset"

## ---------------------- COLORS & APPEARANCE ---------------------- ##
# type:                 layout  layout  invisi. bug_li. border
client.focused          #0377ce #0377ce #ffffff #0377ce #0377ce
client.focused_inactive #313f4e #313f4e #ffffff #313f4e #313f4e
client.unfocused        #252525 #252525 #ffffff #252525 #252525
client.urgent           #87ceeb #87ceeb #104b63 #87ceeb #87ceeb
client.placeholder      #000000 #0c0c0c #ffffff #000000 #0c0c0c
client.background       #ffffff


## ---------------------- AUTOSTART APPLICATIONS ---------------------- ##
# Desktop wallpaper with feh
#exec_always --no-startup-id sleep 1; feh --bg-fill ~/Pictures/wp1.png
exec_always --no-startup-id sleep 1; feh --bg-fill ~/Pictures/default-dark.png

# XDG autostart .desktop files in /etc/xdg/autostart & ~/.config/autostart 
exec --no-startup-id dex-autostart --autostart --environment i3

# OpenTabletDriver daemon i3
exec --no-startup-id otd-daemon

# Greenclip daemon for bindsym
exec --no-startup-id $greenclip daemon

# picom compositor start
exec --no-startup-id picom --daemon --config ~/.config/picom/picom.conf


# Resolution for monitor 1 & 2 (turn off freesync)
set $monitor1 DP-2
set $monitor2 DP-4

exec --no-startup-id xset s 1200 0
exec --no-startup-id xrandr --output $monitor1 --primary --mode 1920x1080 --rate 144.00 --pos 0x420 --output $monitor2 --mode 1920x1080 --rate 144.00 --pos 1920x0 --rotate left



# Font for layouts
font pango: Liberation Mono 9
#font pango:DejaVu Sans Mono 9
#font pango: CaskaydiaCove Nerd Font 8

# Window border style
set $styleborder pixel 3

title_align center
default_floating_border normal
default_border $styleborder
bindsym $mod+Shift+space floating toggle; [tiling con_id=__focused__] border $styleborder; [floating con_id=__focused__] border normal
bindsym --whole-window $mod+Shift+button2 floating toggle; [tiling con_id=__focused__] border $styleborder; [floating con_id=__focused__] border normal

# Window gaps
gaps inner 8
#gaps outer 6
smart_gaps on
# i3WM Scripts
bindsym $mod+b exec --no-startup-id ~/.config/i3/scripts/toggle-top-bar.sh
bindsym $mod+Shift+b exec --no-startup-id ~/.config/i3/scripts/toggle-gaps.sh
bindsym $mod+Control+b exec --no-startup-id ~/.config/i3/scripts/cycle-border-style.sh

## ---------------------- SCRATCHPADS ---------------------- ##
set $scrpwt0 help-dialog_term
set $scrpwt1 alacritty_term
set $scrpwt2 pulsemixer_term
set $scrpwt3 yazi_term
set $scrpwt4 btop_term

set $scrpwc0 ~/.config/scripts/help_menu.sh
set $scrpwc1 ~/.config/i3/scripts/exec-fastfetch.sh
set $scrpwc2 pulsemixer
set $scrpwc3 yazi
set $scrpwc4 btop

# Make the currently focused window a scratchpad
bindsym $mod+Shift+minus exec --no-startup-id i3-msg "move scratchpad" && notify-send -t 2000 "Sending to scratchpad workspace..."

# Show "other" scratchpads that are not set to launch with i3 on startup
bindsym $mod+minus [title="^(?!$scrpwt1|$scrpwt2|$scrpwt3|$scrpwt4).*"] scratchpad show; move position center; [tiling con_id=__focused__] border $styleborder; [floating con_id=__focused__] border normal
# Swap previous bindsym to retain cycling through window functionality:
#bindsym $mod+minus scratchpad show; move position center

# Keybinds
bindsym $mod+Mod1+F1 [title="$scrpwt0"] scratchpad show; move position center
bindsym $mod+Mod1+0 [title="$scrpwt0"] scratchpad show; move position center
bindsym $mod+Mod1+1 [title="$scrpwt1"] scratchpad show; move position center
bindsym $mod+Mod1+2 [title="$scrpwt2"] scratchpad show; move position center
bindsym $mod+Mod1+3 [title="$scrpwt3"] scratchpad show; move position center
bindsym $mod+Mod1+4 [title="$scrpwt4"] scratchpad show; move position center
bindsym Control+Shift+Escape [title="$scrpwt4"] scratchpad show; move position center

# Launching applications for scratchpads

# Help dialog:
exec --no-startup-id sleep 5; notify-send -t 5000 "Help menu" "Press Super + Alt + F1 to view shortcuts"

exec_always --no-startup-id pgrep -f '^alacritty -t $scrpwt0' || alacritty -t $scrpwt0 -e $scrpwc0
for_window [title="$scrpwt0"] move scratchpad, resize set 1050 700

exec_always --no-startup-id pgrep -f '^alacritty -t $scrpwt1' || alacritty -t $scrpwt1 -e $scrpwc1
for_window [title="$scrpwt1"] move scratchpad, resize set 1050 700

exec_always --no-startup-id pgrep -f '^alacritty -t $scrpwt2' || alacritty -t $scrpwt2 -e $scrpwc2
for_window [title="$scrpwt2"] move scratchpad, resize set 850 600

exec_always --no-startup-id pgrep -f '^alacritty -t $scrpwt3' || alacritty -t $scrpwt3 -e $scrpwc3
for_window [title="$scrpwt3"] move scratchpad, resize set 1050 700

exec_always --no-startup-id pgrep -f '^alacritty -t $scrpwt4' || alacritty -t $scrpwt4 -e $scrpwc4
for_window [title="$scrpwt4"] move scratchpad, resize set 1050 700


# Use Super + Mouse to move window
floating_modifier $mod
# Move window to center
bindsym $mod+Shift+Home move position center
bindsym $mod+Shift+End resize set 800 540, move position center
# Kill focused window
bindsym $mod+Shift+q kill
bindsym --whole-window $mod+button2 kill

# Change back to previous workspace
workspace_auto_back_and_forth yes

bindsym $mod+p workspace prev
bindsym $mod+n workspace next
bindsym $mod+Shift+p move to workspace prev, workspace prev
bindsym $mod+Shift+n move to workspace next, workspace next
bindsym $mod+Control+p move to workspace prev
bindsym $mod+Control+n move to workspace next

# move focus (vim keybindings)
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# alternatively, you can use the cursor keys:
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right


# split in horizontal orientation
bindsym $mod+g exec --no-startup-id i3-msg split h && notify-send -t 1000 "Horizontal ← →"
# split in vertical orientation
bindsym $mod+v exec --no-startup-id i3-msg split v && notify-send -t 1000 "Vertical ↑ ↓"
# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle
# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle
# Jump to urgent window
bindsym $mod+x [urgent=latest] focus
# focus the parent container
bindsym $mod+a focus parent
# focus the child container
bindsym $mod+q focus child

# Workspace sorting on monitor 1
set $ws1 "1:1"
set $ws2 "2:2"
set $ws3 "3:3"
set $ws4 "4:4"
set $ws5 "5:5"
set $ws6 "6:6"
set $ws11 "7:GIMP"
workspace $ws1 output $monitor1
workspace $ws2 output $monitor1
workspace $ws3 output $monitor1
workspace $ws4 output $monitor1
workspace $ws5 output $monitor1
workspace $ws6 output $monitor1
workspace $ws11 output $monitor1

# Workspace sorting on monitor 2
set $ws7 "1:F1"
set $ws8 "2:F2"
set $ws9 "3:F3"
set $ws10 "4:F4"
workspace $ws7 output $monitor2
workspace $ws8 output $monitor2
workspace $ws9 output $monitor2
workspace $ws10 output $monitor2

# Go to workspace
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+F1 workspace $ws7
bindsym $mod+F2 workspace $ws8
bindsym $mod+F3 workspace $ws9
bindsym $mod+F4 workspace $ws10

# move focused container to workspace and go to workspace
bindsym $mod+Shift+1 move container to workspace $ws1, workspace $ws1
bindsym $mod+Shift+2 move container to workspace $ws2, workspace $ws2
bindsym $mod+Shift+3 move container to workspace $ws3, workspace $ws3
bindsym $mod+Shift+4 move container to workspace $ws4, workspace $ws4
bindsym $mod+Shift+5 move container to workspace $ws5, workspace $ws5
bindsym $mod+Shift+6 move container to workspace $ws6, workspace $ws6
bindsym $mod+Shift+F1 move container to workspace $ws7, workspace $ws7
bindsym $mod+Shift+F2 move container to workspace $ws8, workspace $ws8
bindsym $mod+Shift+F3 move container to workspace $ws9, workspace $ws9
bindsym $mod+Shift+F4 move container to workspace $ws10, workspace $ws10

# move focused container to workspace
bindsym $mod+Control+1 move container to workspace $ws1
bindsym $mod+Control+2 move container to workspace $ws2
bindsym $mod+Control+3 move container to workspace $ws3
bindsym $mod+Control+4 move container to workspace $ws4
bindsym $mod+Control+5 move container to workspace $ws5
bindsym $mod+Control+6 move container to workspace $ws6
bindsym $mod+Control+F1 move container to workspace $ws7
bindsym $mod+Control+F2 move container to workspace $ws8
bindsym $mod+Control+F3 move container to workspace $ws9
bindsym $mod+Control+F4 move container to workspace $ws10


# move focused window (in layout modes & floating)
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# Move floating window
# Very small move
bindsym $mod+Mod1+Shift+h move left 1 px
bindsym $mod+Mod1+Shift+j move down 1 px
bindsym $mod+Mod1+Shift+k move up 1 px
bindsym $mod+Mod1+Shift+l move right 1 px

# medium move
bindsym $mod+Control+Shift+h move left 200 px
bindsym $mod+Control+Shift+j move down 200 px
bindsym $mod+Control+Shift+k move up 200 px
bindsym $mod+Control+Shift+l move right 200 px

# Big move
bindsym $mod+Mod1+Control+Shift+h move left 600 px
bindsym $mod+Mod1+Control+Shift+j move down 600 px
bindsym $mod+Mod1+Control+Shift+k move up 600 px
bindsym $mod+Mod1+Control+Shift+l move right 600 px


# arrow keys:
# Very small move
bindsym $mod+Mod1+Shift+Up move up 1 px
bindsym $mod+Mod1+Shift+Down move down 1 px
bindsym $mod+Mod1+Shift+Left move left 1 px
bindsym $mod+Mod1+Shift+Right move right 1 px

# medium move
bindsym $mod+Control+Shift+Up move up 200 px
bindsym $mod+Control+Shift+Down move down 200 px
bindsym $mod+Control+Shift+Left move left 200 px
bindsym $mod+Control+Shift+Right move right 200 px

# Big move
bindsym $mod+Mod1+Control+Shift+Up move up 600 px
bindsym $mod+Mod1+Control+Shift+Down move down 600 px
bindsym $mod+Mod1+Control+Shift+Left move left 600 px
bindsym $mod+Mod1+Control+Shift+Right move right 600 px


# floating applications:
## Steam
for_window [class="^steam$"] [title="^Steam$"] move to output $monitor2
for_window [class="^steam$"] [title="^Steam Settings$"] floating enable
for_window [class="^steam$"] [title="^Friends List$"] floating enable
for_window [class="^steam$"] [title="^Geometry Dash$"] floating disable
for_window [class="^steam$"] [title="^Portal$"] floating enable
## File management
for_window [class="^Alacritty$"] [title="^Yazi View$"] border normal, floating enable, resize set 1070 1000, move position center
for_window [class="^Alacritty$"] [title="^File chooser$"] border normal, floating enable, resize set 1070 1000, move position center, move position center
for_window [class="^Dragon$"] [title="^dragon"] move window position pointer

# start a terminal
bindsym $mod+Return exec --no-startup-id alacritty --config-file ~/.config/alacritty/alacritty.toml
# Start lightweight terminal
bindsym $mod+Control+Return exec st

# application shortcuts
bindsym $mod+Mod1+f exec --no-startup-id firefox
bindsym $mod+Mod1+m exec --no-startup-id fooyin
bindsym $mod+Mod1+d exec --no-startup-id vesktop
bindsym $mod+Mod1+y exec --no-startup-id youtube-music
bindsym $mod+Mod1+n exec --no-startup-id thunar
bindsym $mod+Mod1+o exec --no-startup-id obs
bindsym $mod+Mod1+t exec --no-startup-id subl
bindsym $mod+Mod1+g exec --no-startup-id gimp
# Binds for wacom tablet:
bindsym Control+Mod1+Shift+Insert workspace $ws11; exec --no-startup-id gimp
bindsym Control+Mod1+Shift+Delete exec --no-startup-id ~/.config/scripts/toggle_display_wacom.sh
# b3 = ctrl+z | b4 = ctrl+shift+z


# screenshot
# key: PrtSc
bindsym Print exec --no-startup-id flameshot gui
bindsym $mod+Print --release exec --no-startup-id flameshot screen


# media shortcuts
# master volume
set $i3_volume-device ~/.config/i3/scripts/volume-device.sh
set $i3_volume-player ~/.config/i3/scripts/volume-player.sh

bindsym $mod+Prior exec --no-startup-id $i3_volume-device volume_up
bindsym $mod+Next exec --no-startup-id $i3_volume-device volume_down
bindsym $mod+Home exec --no-startup-id $i3_volume-device volume_full
bindsym $mod+Insert exec --no-startup-id $i3_volume-device volume_7
bindsym $mod+Delete exec --no-startup-id $i3_volume-device volume_3
bindsym $mod+End exec --no-startup-id $i3_volume-device volume_mute

# music player controls
bindsym Control+Mod1+Prior exec --no-startup-id $i3_volume-player volume_up
bindsym Control+Mod1+Next exec --no-startup-id $i3_volume-player volume_down
bindsym Control+Mod1+Home exec --no-startup-id $i3_volume-player volume_full
bindsym Control+Mod1+Insert exec --no-startup-id $i3_volume-player volume_7
bindsym Control+Mod1+Delete exec --no-startup-id $i3_volume-player volume_3
bindsym Control+Mod1+End exec --no-startup-id $i3_volume-player volume_mute
# music play controls
bindsym Control+Mod1+Up exec --no-startup-id playerctl play-pause
bindsym Control+Mod1+Down exec --no-startup-id playerctl stop
bindsym Control+Mod1+Left exec --no-startup-id playerctl previous
bindsym Control+Mod1+Right exec --no-startup-id playerctl next


# Rofi Power menu
bindsym $mod+bar exec --no-startup-id ~/.config/rofi/powermenu/type-1/powermenu.sh
bindsym $mod+Shift+Escape exec --no-startup-id ~/.config/rofi/powermenu/type-1/powermenu.sh

# Rofi recently modified files
bindsym $mod+d exec --no-startup-id "fd -t f . -E Games/ -E i3status-rust/ --exec-batch ls -t . ~ | rofi -config ~/.config/rofi/launchers/type-1/style-05.rasi -dmenu -i -p recent_home | xargs -I {} ~/.config/rofi/file_actions.sh {}"

# Rofi run modi command:
bindsym $mod+Shift+Tab exec --no-startup-id "rofi -config ~/.config/rofi/launchers/type-1/style-5.rasi -show run"
# Rofi app modi:
bindsym $mod+Tab exec --no-startup-id "rofi -config ~/.config/rofi/launchers/type-1/style-5.rasi -show drun"
# Rofi window modi:
bindsym Mod1+Tab exec --no-startup-id "rofi -config ~/.config/rofi/launchers/type-1/style-005.rasi -show window"

# Rofi Clipboard manager:
set $greenclip /usr/local/bin/greenclip
bindsym $mod+c exec --no-startup-id "rofi -config ~/.config/rofi/launchers/type-1/style-05.rasi -modi 'clipboard:greenclip print' -show clipboard -run-command '{cmd}'"
# Rofi-calc Calculator:
bindsym $mod+m exec --no-startup-id "rofi -config ~/.config/rofi/launchers/type-1/style-5.rasi -show calc"


# resize without entering resize mode ("2px or 2 ppt"):
set $i3_resize ~/.config/i3/scripts/i3resize.sh

bindsym $mod+Control+h exec --no-startup-id $i3_resize left
bindsym $mod+Control+l exec --no-startup-id $i3_resize right
bindsym $mod+Control+k exec --no-startup-id $i3_resize up
bindsym $mod+Control+j exec --no-startup-id $i3_resize down
bindsym $mod+Control+Left exec --no-startup-id $i3_resize left
bindsym $mod+Control+Right exec --no-startup-id $i3_resize right
bindsym $mod+Control+Up exec --no-startup-id $i3_resize up
bindsym $mod+Control+Down exec --no-startup-id $i3_resize down


# --------------- horizontal monitor bar --------------- #
bar {
    output $monitor1
    font pango:CaskaydiaCove Nerd Font 16
    position top
    padding -2px 0 -2px 0
#    tray_output $monitor1
#    tray_padding 2
    tray_output none
    strip_workspace_numbers yes
    status_command ~/.cargo/bin/i3status-rs ~/.config/i3status-rust/monitor1.toml

    colors {
        background #191f2a
#                          outline fill    text
    	urgent_workspace   #87ceeb #87ceeb #104b63
        focused_workspace  #0377ce #0377ce #ffffff
#       inactive but active:
        active_workspace   #313f4e #313f4e #999999
        inactive_workspace #191f2a #191f2a #777777
    }
}

# --------------- vertical monitor bar --------------- #
bar {
    output $monitor2
#    font pango:CaskaydiaCove Nerd Font 13.6
#    font pango:CaskaydiaCove Nerd Font 13
    font pango:CaskaydiaCove Nerd Font 12.9
    position top
    padding -2px 0 -2px 0
    tray_output $monitor2
    tray_padding 2
    strip_workspace_numbers yes
    status_command ~/.cargo/bin/i3status-rs ~/.config/i3status-rust/monitor2.toml

    colors {
        background #191f2a
#                          outline fill    text
    	urgent_workspace   #87ceeb #87ceeb #104b63
        focused_workspace  #0377ce #0377ce #ffffff
#       inactive but active:
        active_workspace   #313f4e #313f4e #999999
        inactive_workspace #191f2a #191f2a #777777
    }
}
